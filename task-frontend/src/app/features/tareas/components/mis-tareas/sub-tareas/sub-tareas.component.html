<div class="mis-sub-tareas-container">
  <div class="sub-tareas-grid">
    <ion-card *ngFor="let subTarea of subTareas" class="sub-tarea-card" (click)="verDetalle(subTarea)">
      <ion-card-header>
        <div class="card-header-content">
          <ion-checkbox [(ngModel)]="subTarea.completado" (ionChange)="toggleCompletado(subTarea)" (click)="$event.stopPropagation()"></ion-checkbox>
          <ion-card-title [class.completado]="subTarea.completado">{{ subTarea.titulo }}</ion-card-title>
        </div>
      </ion-card-header>

      <ion-card-content>
        <p class="descripcion">{{ subTarea.descripcion }}</p>

        <div class="sub-tarea-meta">
          <div class="meta-item">
            <ion-chip [class]="getPrioridadClass(subTarea.prioridad)" size="small">
              {{ subTarea.prioridad }}
            </ion-chip>
            <ion-chip [class]="getEstadoClass(subTarea.estado)" size="small">
              {{ subTarea.estado }}
            </ion-chip>
          </div>

          <div class="progreso" *ngIf="subTarea.total">
            <span class="progreso-text">{{ subTarea.completadas }}/{{ subTarea.total }}</span>
            <ion-progress-bar [value]="getProgresoSubTarea(subTarea) / 100"></ion-progress-bar>
          </div>

          <div class="fecha" *ngIf="subTarea.fechaVencimiento">
            <ion-icon name="calendar-outline"></ion-icon>
            <span>{{ subTarea.fechaVencimiento | date:'dd/MM/yyyy' }}</span>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <div class="empty-state" *ngIf="subTareas.length === 0">
      <ion-icon name="checkbox-outline"></ion-icon>
      <p>No tienes sub-tareas asignadas</p>
    </div>
  </div>
</div>
